(function(e){function t(t){for(var s,n,a=t[0],c=t[1],l=t[2],u=0,d=[];u<a.length;u++)n=a[u],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&d.push(i[n][0]),i[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);h&&h(t);while(d.length)d.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],s=!0,a=1;a<r.length;a++){var c=r[a];0!==i[c]&&(s=!1)}s&&(o.splice(t--,1),e=n(n.s=r[0]))}return e}var s={},i={app:0},o=[];function n(t){if(s[t])return s[t].exports;var r=s[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=s,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var h=c;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"08cd":function(e,t,r){"use strict";r("d39c")},1036:function(e,t,r){"use strict";r("b6e5")},"293b":function(e,t,r){"use strict";r("d5ae")},"56d7":function(e,t,r){"use strict";r.r(t);var s=r("7a23");const i={class:"container pt-5"},o={key:0},n={key:1};function a(e,t,r,a,c,l){const h=Object(s["m"])("Stats"),u=Object(s["m"])("Char");return Object(s["k"])(),Object(s["e"])("div",i,[Object(s["h"])(h,{avrgTimes:c.avrgTimes,spaceChar:c.spaceChar,level:c.level,targetTime:c.targetTime},null,8,["avrgTimes","spaceChar","level","targetTime"]),c.loadingWords?(Object(s["k"])(),Object(s["e"])("div",n," Loading... ")):(Object(s["k"])(),Object(s["e"])("div",o,[(Object(s["k"])(!0),Object(s["e"])(s["a"],null,Object(s["l"])(l.wordset,(e,t)=>(Object(s["k"])(),Object(s["c"])(u,{class:Object(s["i"])({active:c.cursorPos==t,error:null!=c.errors[t],complete:t<c.cursorPos,space:e==c.spaceChar}),key:t,char:e,errorKey:c.errors[t]},null,8,["class","char","errorKey"]))),128))]))])}const c=["errorkey"],l={key:0};function h(e,t,r,i,o,n){return Object(s["k"])(),Object(s["e"])("span",null,[Object(s["f"])("span",{class:"char",errorkey:r.errorKey},Object(s["n"])(r.char),9,c),"␣"==r.char?(Object(s["k"])(),Object(s["e"])("wbr",l)):Object(s["d"])("",!0)])}var u={props:{char:String,errorKey:String}},d=(r("1036"),r("6b0d")),b=r.n(d),f=b()(u,[["render",h]]);const p={class:"stats mb-4"};function g(e,t,r,i,o,n){const a=Object(s["m"])("Stat");return Object(s["k"])(),Object(s["e"])("div",p,[(Object(s["k"])(!0),Object(s["e"])(s["a"],null,Object(s["l"])(r.avrgTimes,(e,t,i)=>Object(s["p"])((Object(s["k"])(),Object(s["c"])(a,{class:Object(s["i"])({stat:!0,active:i<=r.level-1}),key:t,time:e,letter:t,targetTime:r.targetTime},null,8,["class","time","letter","targetTime"])),[[s["o"],t!=r.spaceChar]])),128))])}function m(e,t,r,i,o,n){return Object(s["k"])(),Object(s["e"])("div",{style:Object(s["j"])([r.time?{backgroundColor:`rgb(${r.time-r.targetTime}, ${r.targetTime+255-r.time}, 0)`}:{backgroundColor:"#eee"}])},[Object(s["g"])(Object(s["n"])(r.letter)+" ",1),Object(s["f"])("span",null,Object(s["n"])(r.time),1)],4)}var y={props:{targetTime:Number,time:Number,letter:String}},j=(r("293b"),b()(y,[["render",m],["__scopeId","data-v-2846d3ef"]])),O={name:"Stats",props:{targetTime:Number,avrgTimes:Object,spaceChar:String,level:Number},components:{Stat:j}},v=(r("08cd"),b()(O,[["render",g]])),w=r("9f9a"),T=new w({placeHolder:" "});const k=new Worker("js/background-word-generator-worker.js");var P={name:"App",components:{Char:f,Stats:v},data(){return{spaceChar:"␣",cursorPos:0,errors:[],subDictionary:[],level:6,letterProgression:"enitrlsauodychgmpbkvwfzxqj",currentWords:[],stats:{},lastLetterTime:0,avrgTimes:{},targetTime:450,averageRange:30,initialSpace:!0,loadingWords:!1,error:null,wordsPerSet:15,dictionaryIndex:0}},computed:{currentLetters(){let e=this.letterProgression.substr(0,this.level);return e},weakestLetters(){let e=this.filterObject(this.avrgTimes,e=>e>this.targetTime),t=Object.fromEntries(Object.entries(e).sort(([,e],[,t])=>t-e)),r=5,s=Object.keys(t).slice(0,r);return s},wordset(){let e=this.currentWords.join(this.spaceChar);return e}},created(){k.onmessage=e=>{Array.isArray(e.data.key)&&e.data.key.forEach((t,r)=>{this[t]=e.data.value[r]}),this[e.data.key]=e.data.value},dictionary=dictionary.filter(e=>e.length<9);for(const e of this.letterProgression)this.stats[e]=[],this.avrgTimes[e]=0;this.loadingWords=!0,this.currentWords=[],this.error&&(this.error=null),k.postMessage({method:"getNewWordSets",args:[this.wordsPerSet,this.weakestLetters,this.currentLetters,Object.values(this.subDictionary),this.dictionaryIndex,!0]}),window.addEventListener("keyup",this.keyHandler)},methods:{filterObject(e,t){let r=Object.keys(e).filter(r=>t(e[r])).reduce((t,r)=>(t[r]=e[r],t),{});return r},keyHandler(e){if(this.cursorPos<this.wordset.length-1&&!this.loadingWords){let t=e.key;if(this.errors[this.cursorPos]=null,"Backspace"==t)return void this.cursorPos--;" "==t&&(t=this.spaceChar);let r=Date.now(),s=null,i=null,o=this.wordset[this.cursorPos];if(this.wordset[this.cursorPos]==t||0==this.cursorPos&&t==this.spaceChar&&this.initialSpace){if(0==this.cursorPos&&t==this.spaceChar)return void(this.initialSpace=!1);s=!0,i=this.getTimeToType(r),this.cursorPos++}else s=!1,this.errors[this.cursorPos]=t,i=this.getTimeToType(r)+400,console.log(i),this.cursorPos++;!this.stats[o]&&(this.stats[o]=[]),this.stats[o].unshift({timestamp:r,timeToType:i,hit:s}),this.stats[o]=this.stats[o].slice(0,this.averageRange);for(const e in this.stats)if(Object.hasOwnProperty.call(this.stats,e)){const t=this.stats[e];if(t.length){let r=0;this.avrgTimes[e]=t.reduce((e,s)=>(r++,e+=s.timeToType,t.length==r&&(e=Math.floor(e/r)),e),0)}}}else if(!this.loadingWords&&this.cursorPos==this.wordset.length-1){let e=!1;const t=this.isBelowThreshhold(this.targetTime);t&&(this.level++,e=!0),this.cursorPos=0,this.errors=[],this.lastLetterTime=0,this.initialSpace=!0,this.loadingWords=!0,this.currentWords=[],this.error&&(this.error=null),k.postMessage({method:"getNewWordSets",args:[this.wordsPerSet,this.weakestLetters,this.currentLetters,Object.values(this.subDictionary),this.dictionaryIndex,e]})}},getTimeToType(e){!this.lastLetterTime&&(this.lastLetterTime=e);let t=e-this.lastLetterTime;return this.lastLetterTime=e,t},isBelowThreshhold(e){for(const t of Object.values(this.avrgTimes))if(t>e)return!1;return!0},getNewWordSet(){this.currentWords=[],this.error&&(this.error=null);let e=this.weakestLetters,t=this.currentLetters,r=Object.values(this.subDictionary);k.postMessage({method:"getNewWordSets",args:[this.wordsPerSet,e,t,r,this.dictionaryIndex]})},updateSubDictionary(){let e=this.currentLetters,t="abcdefghijklmnopqrstuvwxyz";while(e.length)t=t.replace(e[0],""),e=e.substring(1);let r="/^["+t+"]*$/",s=(new RegExp(r,"g"),dictionary.filter(e=>{for(const r of t)if(e.includes(r))return!1;return!0}));return this.shuffleArray(s),s},getWordWithLetters(){let e=this.weakestLetters;for(const s of e)if(!this.currentLetters.includes(s)){e=[];break}let t="",r=!1;while(!r){r=!0,t=this.getWord();for(const s of e)t.includes(s)||(r=!1)}return t},getWord(){let e=T.clean(this.subDictionary[this.dictionaryIndex]);while(!e.trim())this.nextDictionaryIndex(),e=T.clean(this.subDictionary[this.dictionaryIndex]);return this.nextDictionaryIndex(),e},nextDictionaryIndex(){this.dictionaryIndex==this.subDictionary.length?this.dictionaryIndex=0:this.dictionaryIndex++},checkClean(){let e=dictionary,t=0;for(const r of dictionary){let s=T.clean(r);s.trim()||e.splice(t,1),t++}},shuffleArray(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}}}},S=(r("a37d"),b()(P,[["render",a]]));r("7b17"),r("f9e3");Object(s["b"])(S).mount("#app")},a37d:function(e,t,r){"use strict";r("aa0c")},aa0c:function(e,t,r){},b6e5:function(e,t,r){},d39c:function(e,t,r){},d5ae:function(e,t,r){}});
//# sourceMappingURL=app.43092efe.js.map